[{"id":"f4cfd7d9.b679d8","type":"tab","label":"流程1","disabled":false,"info":""},{"id":"2b9c963d.446dfa","type":"tab","label":"流程2","disabled":false,"info":""},{"id":"f41a409d.230a4","type":"tab","label":"流程3","disabled":false,"info":""},{"id":"360aff99.34f32","type":"tab","label":"流程4","disabled":false,"info":""},{"id":"b2ef928e.05511","type":"tab","label":"流程5","disabled":false,"info":""},{"id":"e5aacac3.9bf018","type":"tab","label":"流程6","disabled":false,"info":""},{"id":"13c3b8cc.1182d7","type":"tab","label":"流程7","disabled":false,"info":""},{"id":"3c4ceb9f.0b9b94","type":"debug","z":"f4cfd7d9.b679d8","name":"dubugname","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":750,"y":1340,"wires":[]},{"id":"7ef58cbc.33a934","type":"http request","z":"2b9c963d.446dfa","name":"商品服务","method":"POST","ret":"obj","url":"http://172.21.12.228:8763/product/query","timeout":"3000","uniqueId":"http://172.21.12.228:8763/product/query","tls":"","x":500,"y":300,"wires":[["ff6c3949.4a0418"]]},{"id":"daf651a7.63ba","type":"http request","z":"2b9c963d.446dfa","name":"用户服务","method":"POST","ret":"obj","url":"http://172.21.12.228:8764/user/query","timeout":"3000","uniqueId":"http://172.21.12.228:8764/user/query","tls":"","x":480,"y":420,"wires":[["33413ddb.21d902"]]},{"id":"ff6c3949.4a0418","type":"function","z":"2b9c963d.446dfa","name":"获取商品信息","func":"var product=msg.payload.name;\n\nmsg.payload={\n    \"product\":product\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":668,"y":300,"wires":[["5ce61590.ba1fcc","2aab309a.9811c"]]},{"id":"5ce61590.ba1fcc","type":"debug","z":"2b9c963d.446dfa","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":660,"y":160,"wires":[]},{"id":"b0ff73e9.1883","type":"function","z":"2b9c963d.446dfa","name":"获取商品ID","func":"var productId = msg.payload.productId;\n\nmsg.payload={\n    \"id\":productId\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":300,"wires":[["7ef58cbc.33a934","a94946c.3664cb8"]]},{"id":"fc8ab3bb.290ae","type":"function","z":"2b9c963d.446dfa","name":"获取用户ID","func":"var userId = msg.payload.userId;\n\nmsg.payload={\n    \"id\": userId\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":420,"wires":[["daf651a7.63ba","3b24bc01.045224"]]},{"id":"33413ddb.21d902","type":"function","z":"2b9c963d.446dfa","name":"获取用户信息","func":"var user=msg.payload.name;\n\nmsg.payload={\n    \"user\":user\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":420,"wires":[["6b23e06e.35008","c329d65b.06ef28"]]},{"id":"6b23e06e.35008","type":"debug","z":"2b9c963d.446dfa","name":"","active":true,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":680,"y":540,"wires":[]},{"id":"3b24bc01.045224","type":"debug","z":"2b9c963d.446dfa","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":340,"y":540,"wires":[],"inputLabels":["dsadasdsadsad"]},{"id":"a94946c.3664cb8","type":"debug","z":"2b9c963d.446dfa","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"true","x":310,"y":160,"wires":[]},{"id":"78f60855.e70c68","type":"http response","z":"2b9c963d.446dfa","name":"","statusCode":"200","headers":{"content-type":"application/json"},"x":1440,"y":360,"wires":[]},{"id":"fa5a9555.e7b578","type":"debug","z":"2b9c963d.446dfa","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":1180,"y":280,"wires":[]},{"id":"efa0e814.397bb8","type":"http in","z":"2b9c963d.446dfa","name":"","url":"/create/order","method":"get","upload":false,"swaggerDoc":"","x":140,"y":380,"wires":[["b0ff73e9.1883","fc8ab3bb.290ae"]]},{"id":"617dda97.cd4ff4","type":"join","z":"2b9c963d.446dfa","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"3","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":970,"y":360,"wires":[["fa5a9555.e7b578","83532d96.1b8bf"]]},{"id":"c329d65b.06ef28","type":"split","z":"2b9c963d.446dfa","name":"","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"topic","x":850,"y":420,"wires":[["617dda97.cd4ff4"]]},{"id":"d8a18c9.2ebd57","type":"debug","z":"2b9c963d.446dfa","name":"","active":true,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":1400,"y":280,"wires":[]},{"id":"eb4f335e.14b0d","type":"http in","z":"f4cfd7d9.b679d8","name":"","url":"/test1","method":"get","upload":false,"swaggerDoc":"","x":100,"y":180,"wires":[["6b93e8b1.946c18"]]},{"id":"909d99ae.6f6268","type":"http response","z":"f4cfd7d9.b679d8","name":"","statusCode":"","headers":{},"x":770,"y":200,"wires":[]},{"id":"6b93e8b1.946c18","type":"http request","z":"f4cfd7d9.b679d8","name":"","method":"GET","ret":"txt","url":"http://172.21.224.233:8767/user/1","timeout":"3000","uniqueId":"http://172.21.224.233:8767/user/1","tls":"","x":260,"y":180,"wires":[["909d99ae.6f6268"]]},{"id":"5fec1091.cf8bc","type":"http request","z":"2b9c963d.446dfa","name":"商品服务","method":"POST","ret":"obj","url":"http://172.21.12.228:8763/product/query","timeout":"3000","uniqueId":"http://172.21.12.228:8763/product/query","tls":"","x":520,"y":680,"wires":[["9c4e94f8.e9d9f8"]]},{"id":"f2466d43.efcff","type":"http in","z":"2b9c963d.446dfa","name":"","url":"/product","method":"get","upload":false,"swaggerDoc":"","x":130,"y":680,"wires":[["28eb1ef6.4064f2"]]},{"id":"28eb1ef6.4064f2","type":"function","z":"2b9c963d.446dfa","name":"","func":"var id = msg.payload.id;\n\nmsg.payload={\n    \"id\": id\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":680,"wires":[["5fec1091.cf8bc"]]},{"id":"9c4e94f8.e9d9f8","type":"http response","z":"2b9c963d.446dfa","name":"","statusCode":"200","headers":{"content-type":"application/json"},"x":740,"y":680,"wires":[]},{"id":"8bf1c473.035398","type":"http in","z":"2b9c963d.446dfa","name":"","url":"/user","method":"get","upload":false,"swaggerDoc":"","x":120,"y":760,"wires":[["ab235956.6e57d8"]]},{"id":"ff1216d.9ac9be8","type":"http response","z":"2b9c963d.446dfa","name":"","statusCode":"200","headers":{"content-type":"application/json"},"x":740,"y":760,"wires":[]},{"id":"ab235956.6e57d8","type":"function","z":"2b9c963d.446dfa","name":"","func":"var id = msg.payload.id;\n\nmsg.payload={\n    \"id\": id\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":760,"wires":[["7fc61dde.440db4"]]},{"id":"7fc61dde.440db4","type":"http request","z":"2b9c963d.446dfa","name":"用户服务","method":"POST","ret":"obj","url":"http://172.21.12.228:8764/user/query","timeout":"3000","uniqueId":"http://172.21.12.228:8764/user/query","tls":"","x":520,"y":760,"wires":[["ff1216d.9ac9be8"]]},{"id":"2aab309a.9811c","type":"split","z":"2b9c963d.446dfa","name":"","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"topic","x":890,"y":240,"wires":[["617dda97.cd4ff4"]]},{"id":"83532d96.1b8bf","type":"http request","z":"2b9c963d.446dfa","name":"订单信息","method":"POST","ret":"obj","url":"http://172.21.12.228:8762/order/add","timeout":"3000","uniqueId":"http://172.21.12.228:8762/order/add","tls":"","x":1200,"y":360,"wires":[["d8a18c9.2ebd57","78f60855.e70c68"]]},{"id":"633b57c.f1f2da8","type":"http in","z":"f41a409d.230a4","name":"","url":"/hello-cookie","method":"get","upload":false,"swaggerDoc":"","x":290,"y":140,"wires":[["e4ae1a62.2c7368"]]},{"id":"e4ae1a62.2c7368","type":"function","z":"f41a409d.230a4","name":"Format cookies","func":"msg.payload = JSON.stringify(msg.req.cookies,null,4);\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":140,"wires":[["e390d9f9.848678"]]},{"id":"e390d9f9.848678","type":"template","z":"f41a409d.230a4","name":"page","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n    <head></head>\n    <body>\n        <h1>Cookies</h1>\n        <p></p><a href=\"hello-cookie/add\">Add a cookie</a> &bull; <a href=\"hello-cookie/clear\">Clear cookies</a></p>\n        <pre>{{ payload }}</pre>\n    </body>\n</html>","output":"str","x":810,"y":140,"wires":[["1b6f43cc.a940cc"]]},{"id":"1b6f43cc.a940cc","type":"http response","z":"f41a409d.230a4","name":"","x":1050,"y":140,"wires":[]},{"id":"6745d15f.6eccc","type":"change","z":"f41a409d.230a4","name":"Redirect to /hello-cookie","rules":[{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"},{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/hello-cookie","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":220,"wires":[["1b6f43cc.a940cc"]]},{"id":"9ea27461.205508","type":"function","z":"f41a409d.230a4","name":"Add a cookie","func":"msg.cookies = { };\nmsg.cookies[\"demo-\"+(Math.floor(Math.random()*1000))] = Date.now();\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":200,"wires":[["6745d15f.6eccc"]]},{"id":"8ecffb4a.113d28","type":"function","z":"f41a409d.230a4","name":"Clear cookies","func":"// Find demo cookies and clear them\nvar cookieNames = Object.keys(msg.req.cookies).filter(function(cookieName) { return /^demo-/.test(cookieName);});\nmsg.cookies = {};\n\ncookieNames.forEach(function(cookieName) {\n    msg.cookies[cookieName] = null;\n});\n\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":260,"wires":[["6745d15f.6eccc"]]},{"id":"151731b3.f2050e","type":"http in","z":"f41a409d.230a4","name":"","url":"/hello-cookie/add","method":"get","upload":false,"swaggerDoc":"","x":300,"y":200,"wires":[["9ea27461.205508"]]},{"id":"c7e9e984.9cb7b8","type":"http in","z":"f41a409d.230a4","name":"","url":"/hello-cookie/clear","method":"get","upload":false,"swaggerDoc":"","x":300,"y":260,"wires":[["8ecffb4a.113d28"]]},{"id":"355ddddc.60b8a2","type":"change","z":"f4cfd7d9.b679d8","name":"","rules":[{"t":"move","p":"payload.id","pt":"msg","to":"payload.header.id","tot":"msg"},{"t":"move","p":"payload.name","pt":"msg","to":"payload.header.name","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":440,"wires":[["fc0d2493.717608"]]},{"id":"72485f0e.db59b","type":"inject","z":"f4cfd7d9.b679d8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":440,"wires":[["5e9839e8.ae3c68"]]},{"id":"fc0d2493.717608","type":"debug","z":"f4cfd7d9.b679d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":680,"y":440,"wires":[]},{"id":"5e9839e8.ae3c68","type":"function","z":"f4cfd7d9.b679d8","name":"","func":"msg.payload={\n    \"id\":11111,\n    \"name\":\"tom\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":250,"y":540,"wires":[["355ddddc.60b8a2"]]},{"id":"82d21825.493f6","type":"http in","z":"360aff99.34f32","name":"","url":"/esbTest","method":"post","upload":false,"swaggerDoc":"","x":290,"y":260,"wires":[["f8a0779a.3def58"]]},{"id":"b0e85295.90333","type":"http response","z":"360aff99.34f32","name":"","statusCode":"","headers":{},"x":750,"y":260,"wires":[]},{"id":"f8a0779a.3def58","type":"http request","z":"360aff99.34f32","name":"","method":"POST","ret":"txt","url":"http://172.21.10.30:53000/esbWS/rest/test_com_rest_string","timeout":"3000","uniqueId":"http://172.21.10.30:53000/esbWS/rest/test_com_rest_string","tls":"","x":520,"y":260,"wires":[["b0e85295.90333","be695f46.d6a05"]]},{"id":"be695f46.d6a05","type":"debug","z":"360aff99.34f32","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":770,"y":320,"wires":[]},{"id":"e7f72412.0688d8","type":"inject","z":"f4cfd7d9.b679d8","name":"","topic":"","payload":"{\"ROOT\":{\"HEADER\":{\"ROUTING\":{\"ROUTE_KEY\":\"\",\"ROUTE_VALUE\":\"\"},\"PARENT_CALL_ID\":\"9A0EF1E36FBC04EB1EEB4D7CCC12D10E\",\"TRACE_ID\":\"90*20180731131404*JCFX*023276*947680\"},\"OP_CODE\":\"4396\",\"LOGIN_NO\":\"system\",\"ORG_CODE\":\"01001001\",\"TRANS_CODE\":\"T2002092\",\"BIP_CODE\":\"BIP&&&2C092\",\"IN_DATA\":{\"HOMEPROV\":\"351\",\"GROUP_ID\":\"11547\",\"OPERATECONDITIONS\":\"18335266894\",\"SVCCITY\":\"11547\",\"ACCEPTTIME\":\"2018-07-31 13:14:07\",\"REGION_ID\":\"0\",\"ACCEPTSTAFF\":\"\",\"INDICTSEQ\":\"20180731CSVC3510524781\",\"SUBSBRAND\":\"\",\"OPERATETYPEID\":\"01001\",\"ORIGINTIME\":\"2018-07-31 13:14:07\",\"CONTACTCHANNEL\":\"08\",\"SERVICETYPEID\":\"57\"}}}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":680,"wires":[["60738f36.f9af9","7e57db2a.521754"]]},{"id":"a26f1ae3.3b3098","type":"debug","z":"f4cfd7d9.b679d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":680,"wires":[]},{"id":"60738f36.f9af9","type":"change","z":"f4cfd7d9.b679d8","name":"","rules":[{"t":"set","p":"payload.ROOT.OPTION_CODE","pt":"msg","to":"$number(payload.ROOT.OP_CODE) * 10\t","tot":"jsonata"},{"t":"delete","p":"payload.ROOT.OP_CODE","pt":"msg"},{"t":"set","p":"payload.ROOT.BIP","pt":"msg","to":"$split(payload.ROOT.BIP_CODE,'&&&')[0]\t\t","tot":"jsonata"},{"t":"set","p":"payload.ROOT.CODE","pt":"msg","to":"$split(payload.ROOT.BIP_CODE,'&&&')[1]","tot":"jsonata"},{"t":"delete","p":"payload.ROOT.BIP_CODE","pt":"msg"},{"t":"set","p":"payload.ROOT.LOGIN_ORG","pt":"msg","to":"payload.ROOT.LOGIN_NO & payload.ROOT.ORG_CODE","tot":"jsonata"},{"t":"delete","p":"payload.ROOT.LOGIN_NO","pt":"msg"},{"t":"delete","p":"payload.ROOT.ORG_CODE","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":340,"y":680,"wires":[["a26f1ae3.3b3098"]]},{"id":"1cff420f.865a3e","type":"xml","z":"f4cfd7d9.b679d8","name":"忽略属性","property":"payload","attr":"","chr":"","x":300,"y":740,"wires":[["4ae0c13b.d104b","cc12dbd2.675448"]]},{"id":"da5dfd20.b6459","type":"inject","z":"f4cfd7d9.b679d8","name":"","topic":"","payload":"<?xml version=\"1.0\" encoding=\"UTF-8\"?> <ROOT><BODY class=\"object\"><AUTHEN_INFO class=\"object\"><APP_ID type=\"string\">2000</APP_ID><APP_NAME type=\"string\">NGBOSS</APP_NAME><AUTHEN_OP_CODE type=\"string\">9999</AUTHEN_OP_CODE><CLASS_CODE type=\"string\">3000</CLASS_CODE><DEST_IP type=\"string\">172.21.11.62</DEST_IP><DEST_PORT type=\"string\">7100</DEST_PORT><FROM_SYS type=\"string\">BOSS</FROM_SYS><GROUP_ID type=\"string\">2</GROUP_ID><IP_ADDRESS type=\"string\">127.0.0.1</IP_ADDRESS><LOGIN_NO type=\"string\">aagh5P</LOGIN_NO><LOGIN_PWD type=\"string\">adsfasefasf</LOGIN_PWD><REGION_ID type=\"string\">11</REGION_ID><ROUND_AUDIT type=\"string\">Y</ROUND_AUDIT><SER_NAME type=\"string\">sGetUserList</SER_NAME><SESSION_ID type=\"string\">sadfsafhwefjs,dfsldafjioasndmfsdfsdf</SESSION_ID><SRC_PORT type=\"string\">7200</SRC_PORT><WSG_SVC_ID type=\"string\">WSGOUP09190001</WSG_SVC_ID></AUTHEN_INFO><COMMON_INFO class=\"object\"><APP_ID type=\"string\">2000</APP_ID><APP_NAME type=\"string\">NGBOSS</APP_NAME><DEST_IP type=\"string\">172.21.11.62</DEST_IP><DEST_PORT type=\"string\">7100</DEST_PORT><FROM_SYS type=\"string\">BOSS</FROM_SYS><PROVINCE_GROUP type=\"string\">10008</PROVINCE_GROUP><ROUND_AUDIT type=\"string\"/><SESSION_ID type=\"string\">sadfsafhwefjs,dfsldafjioasndmfsdfsdf</SESSION_ID><SRC_PORT type=\"string\">7200</SRC_PORT></COMMON_INFO><REQUEST_INFO class=\"object\"><BUSI_INFO_LIST class=\"object\"><BUSI_INFO class=\"object\"><ADD_SERVICE_NO type=\"string\">13880006618</ADD_SERVICE_NO><LOGIN_TYPE type=\"string\">0</LOGIN_TYPE></BUSI_INFO></BUSI_INFO_LIST><OPR_INFO class=\"object\"><AUTHEN_CODE type=\"string\"/><AUTHEN_NAME type=\"string\"/><CHANNEL_TYPE type=\"string\">3000</CHANNEL_TYPE><GROUP_ID type=\"string\">2</GROUP_ID><IP_ADDRESS type=\"string\">127.0.0.1</IP_ADDRESS><LOGIN_NO type=\"string\">aagh5P</LOGIN_NO><LOGIN_PWD type=\"string\">adsfasefasf</LOGIN_PWD><REGION_ID type=\"string\">11</REGION_ID></OPR_INFO></REQUEST_INFO></BODY><HEADER class=\"object\"><CHANNEL_ID type=\"string\">11</CHANNEL_ID><CONTACT_ID type=\"string\">-1</CONTACT_ID><ENDUSRIP type=\"string\">127.0.0.1</ENDUSRIP><KEEP_LIVE type=\"string\">127.0.0.1</KEEP_LIVE><PARENT_CALL_ID type=\"string\">52bc9dcc-b1a3-461a-ac7e-5120edaa6f3f</PARENT_CALL_ID><PASSWORD type=\"string\">root</PASSWORD><POOL_ID type=\"string\">11</POOL_ID><ROUTING class=\"object\"><ROUTE_KEY type=\"string\">15</ROUTE_KEY><ROUTE_VALUE type=\"string\">11</ROUTE_VALUE></ROUTING><TRACE_ID type=\"string\">11*20171114150349660*9999*aagh5P*649770</TRACE_ID><USERNAME type=\"string\">root</USERNAME></HEADER></ROOT>","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":740,"wires":[["1cff420f.865a3e","8c4e00e1.119d7"]]},{"id":"8f28bec.a43ee4","type":"debug","z":"f4cfd7d9.b679d8","name":"xml","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":650,"y":740,"wires":[]},{"id":"8c4e00e1.119d7","type":"xml","z":"f4cfd7d9.b679d8","name":"保留属性","property":"payload","attr":"","chr":"","x":300,"y":780,"wires":[["4ae0c13b.d104b","cc12dbd2.675448"]]},{"id":"4ae0c13b.d104b","type":"xml","z":"f4cfd7d9.b679d8","name":"js2xml","property":"payload","attr":"","chr":"","x":490,"y":740,"wires":[["8f28bec.a43ee4"]]},{"id":"cc12dbd2.675448","type":"json","z":"f4cfd7d9.b679d8","name":"","property":"payload","action":"","pretty":false,"x":490,"y":780,"wires":[["8a36b584.699058"]]},{"id":"8a36b584.699058","type":"debug","z":"f4cfd7d9.b679d8","name":"json","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":650,"y":780,"wires":[]},{"id":"632931c7.1d11d4","type":"dubbo2","z":"b2ef928e.05511","name":"sayHello","app":"consumer-demo","registry":"172.21.10.130:2181","hsfver":"2.5.7","interface":"com.sitech.hsf.Interface.ServerA","serverVer":"1.0.0","timeout":10,"group":"","method":"{sayHello(name){return [java.String(name)];}}","methodName":"sayHello","uniqueId":"com.sitech.hsf.Interface.ServerA.sayHello","x":620,"y":380,"wires":[["894ddca2.4649f","b2c12cb8.c1af1"]]},{"id":"894ddca2.4649f","type":"http response","z":"b2ef928e.05511","name":"","statusCode":"","headers":{},"x":850,"y":420,"wires":[]},{"id":"b2c12cb8.c1af1","type":"debug","z":"b2ef928e.05511","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":850,"y":260,"wires":[]},{"id":"7b081b32.21c96","type":"function","z":"b2ef928e.05511","name":"入参","func":"\nmsg.payload={\n    name:'帅到掉渣',\n    id: 12\n}\nreturn msg;","outputs":1,"noerr":0,"x":430,"y":400,"wires":[["632931c7.1d11d4"]]},{"id":"d34daeab.765d3","type":"inject","z":"b2ef928e.05511","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":300,"y":260,"wires":[["7b081b32.21c96"]]},{"id":"bee95b41.0e9698","type":"inject","z":"f4cfd7d9.b679d8","name":"","topic":"","payload":"<?xml version=\"1.0\" encoding=\"UTF-8\"?> <ROOT><BODY class=\"object\"><AUTHEN_INFO class=\"object\"><APP_ID type=\"string\">2000</APP_ID><APP_NAME type=\"string\">NGBOSS</APP_NAME><AUTHEN_OP_CODE type=\"string\">9999</AUTHEN_OP_CODE><CLASS_CODE type=\"string\">3000</CLASS_CODE><DEST_IP type=\"string\">172.21.11.62</DEST_IP><DEST_PORT type=\"string\">7100</DEST_PORT><FROM_SYS type=\"string\">BOSS</FROM_SYS><GROUP_ID type=\"string\">2</GROUP_ID><IP_ADDRESS type=\"string\">127.0.0.1</IP_ADDRESS><LOGIN_NO type=\"string\">aagh5P</LOGIN_NO><LOGIN_PWD type=\"string\">adsfasefasf</LOGIN_PWD><REGION_ID type=\"string\">11</REGION_ID><ROUND_AUDIT type=\"string\">Y</ROUND_AUDIT><SER_NAME type=\"string\">sGetUserList</SER_NAME><SESSION_ID type=\"string\">sadfsafhwefjs,dfsldafjioasndmfsdfsdf</SESSION_ID><SRC_PORT type=\"string\">7200</SRC_PORT><WSG_SVC_ID type=\"string\">WSGOUP09190001</WSG_SVC_ID></AUTHEN_INFO><COMMON_INFO class=\"object\"><APP_ID type=\"string\">2000</APP_ID><APP_NAME type=\"string\">NGBOSS</APP_NAME><DEST_IP type=\"string\">172.21.11.62</DEST_IP><DEST_PORT type=\"string\">7100</DEST_PORT><FROM_SYS type=\"string\">BOSS</FROM_SYS><PROVINCE_GROUP type=\"string\">10008</PROVINCE_GROUP><ROUND_AUDIT type=\"string\"/><SESSION_ID type=\"string\">sadfsafhwefjs,dfsldafjioasndmfsdfsdf</SESSION_ID><SRC_PORT type=\"string\">7200</SRC_PORT></COMMON_INFO><REQUEST_INFO class=\"object\"><BUSI_INFO_LIST class=\"object\"><BUSI_INFO class=\"object\"><ADD_SERVICE_NO type=\"string\">13880006618</ADD_SERVICE_NO><LOGIN_TYPE type=\"string\">0</LOGIN_TYPE></BUSI_INFO></BUSI_INFO_LIST><OPR_INFO class=\"object\"><AUTHEN_CODE type=\"string\"/><AUTHEN_NAME type=\"string\"/><CHANNEL_TYPE type=\"string\">3000</CHANNEL_TYPE><GROUP_ID type=\"string\">2</GROUP_ID><IP_ADDRESS type=\"string\">127.0.0.1</IP_ADDRESS><LOGIN_NO type=\"string\">aagh5P</LOGIN_NO><LOGIN_PWD type=\"string\">adsfasefasf</LOGIN_PWD><REGION_ID type=\"string\">11</REGION_ID></OPR_INFO></REQUEST_INFO></BODY><HEADER class=\"object\"><CHANNEL_ID type=\"string\">11</CHANNEL_ID><CONTACT_ID type=\"string\">-1</CONTACT_ID><ENDUSRIP type=\"string\">127.0.0.1</ENDUSRIP><KEEP_LIVE type=\"string\">127.0.0.1</KEEP_LIVE><PARENT_CALL_ID type=\"string\">52bc9dcc-b1a3-461a-ac7e-5120edaa6f3f</PARENT_CALL_ID><PASSWORD type=\"string\">root</PASSWORD><POOL_ID type=\"string\">11</POOL_ID><ROUTING class=\"object\"><ROUTE_KEY type=\"string\">15</ROUTE_KEY><ROUTE_VALUE type=\"string\">11</ROUTE_VALUE></ROUTING><TRACE_ID type=\"string\">11*20171114150349660*9999*aagh5P*649770</TRACE_ID><USERNAME type=\"string\">root</USERNAME></HEADER></ROOT>","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":980,"wires":[["2cf79368.314fcc","9efbc07c.27402"]]},{"id":"b08e1305.a97f9","type":"json","z":"f4cfd7d9.b679d8","name":"","property":"payload","action":"","pretty":false,"x":650,"y":940,"wires":[["ff7b15ac.2d3cb8"]]},{"id":"dbe790ec.09a09","type":"xml","z":"f4cfd7d9.b679d8","name":"","property":"payload","attr":"","chr":"","x":650,"y":1060,"wires":[["7e018f4b.d1835"]]},{"id":"ff7b15ac.2d3cb8","type":"debug","z":"f4cfd7d9.b679d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":870,"y":940,"wires":[]},{"id":"7e018f4b.d1835","type":"debug","z":"f4cfd7d9.b679d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":870,"y":1040,"wires":[]},{"id":"2cf79368.314fcc","type":"xml","z":"f4cfd7d9.b679d8","name":"","property":"payload","attr":"","chr":"","x":410,"y":940,"wires":[["b08e1305.a97f9"]]},{"id":"9efbc07c.27402","type":"xml","z":"f4cfd7d9.b679d8","name":"","property":"payload","attr":"","chr":"","x":390,"y":1060,"wires":[["dbe790ec.09a09"]]},{"id":"7e57db2a.521754","type":"debug","z":"f4cfd7d9.b679d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":480,"y":620,"wires":[]},{"id":"aa5c8ebd.6d2e3","type":"debug","z":"f4cfd7d9.b679d8","name":"转换后","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":850,"y":2780,"wires":[]},{"id":"f4911502.7a5b68","type":"inject","z":"f4cfd7d9.b679d8","name":"","topic":"","payload":"[3,4]","payloadType":"bin","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":2820,"wires":[["5340fb92.796b44"]]},{"id":"5340fb92.796b44","type":"function","z":"f4cfd7d9.b679d8","name":"传入chage标签中的报文","func":"msg.payload = {\"ROOT\":{\"HEADER\":{\"ROUTING\":{\"ROUTE_KEY\":\"\",\"ROUTE_VALUE\":\"\"},\"PARENT_CALL_ID\":\"9A0EF1E36FBC04EB1EEB4D7CCC12D10E\",\"TRACE_ID\":\"90*20180731131404*JCFX*023276*947680\"},\"OP_CODE\":\"4396\",\"LOGIN_NO\":\"system\",\"ORG_CODE\":\"01001001\",\"TRANS_CODE\":\"T2002092\",\"BIP_CODE\":\"BIP&&&2C092\",\"IN_DATA\":{\"HOMEPROV\":\"351\",\"GROUP_ID\":\"11547\",\"OPERATECONDITIONS\":\"18335266894\",\"SVCCITY\":\"11547\",\"ACCEPTTIME\":\"2018-07-31 13:14:07\",\"REGION_ID\":\"0\",\"ACCEPTSTAFF\":\"\",\"INDICTSEQ\":\"20180731CSVC3510524781\",\"SUBSBRAND\":\"\",\"OPERATETYPEID\":\"01001\",\"ORIGINTIME\":\"2018-07-31 13:14:07\",\"CONTACTCHANNEL\":\"08\",\"SERVICETYPEID\":\"57\"}}}\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":2820,"wires":[["d56cbbe0.c55008","e183144b.35d018"]]},{"id":"d56cbbe0.c55008","type":"change","z":"f4cfd7d9.b679d8","name":"报文格式转换","rules":[{"t":"set","p":"payload.ROOT.OP_CODE","pt":"msg","to":"$split(payload, \"-\")","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":2780,"wires":[["aa5c8ebd.6d2e3"]]},{"id":"e183144b.35d018","type":"debug","z":"f4cfd7d9.b679d8","name":"转换前","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":670,"y":2900,"wires":[]},{"id":"f70e674.f8a4998","type":"http request","z":"f4cfd7d9.b679d8","name":"","method":"GET","ret":"txt","url":"http://172.21.214.157:8080/find","timeout":"3000","uniqueId":"http://172.21.214.157:8080/find","tls":"","x":540,"y":1420,"wires":[["3c4ceb9f.0b9b94","5de835f7.2b4794"]]},{"id":"73c4a354.5a1c4c","type":"http in","z":"f4cfd7d9.b679d8","name":"","url":"/ww","method":"get","upload":false,"swaggerDoc":"","x":200,"y":1420,"wires":[["f70e674.f8a4998"]]},{"id":"5de835f7.2b4794","type":"http response","z":"f4cfd7d9.b679d8","name":"","statusCode":"","headers":{},"x":760,"y":1460,"wires":[]},{"id":"6ac1d9d.65a4d28","type":"inject","z":"f4cfd7d9.b679d8","name":"时间戳","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":390,"y":2540,"wires":[["e93c97dd.e82208"]]},{"id":"e93c97dd.e82208","type":"function","z":"f4cfd7d9.b679d8","name":"functin","func":"msg.payload = \"aaa\";\nmsg.aa = \"bbb1\";\nreturn msg;","outputs":1,"noerr":0,"x":570,"y":2560,"wires":[["ffc57bce.5f3688"]]},{"id":"ffc57bce.5f3688","type":"debug","z":"f4cfd7d9.b679d8","name":"dubug","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":750,"y":2560,"wires":[]},{"id":"8d80f44.10404c8","type":"http request","z":"e5aacac3.9bf018","name":"商品服务","method":"POST","ret":"obj","url":"http://172.21.11.172:8763/product/query","timeout":"2000","uniqueId":"http://172.21.11.172:8763/product/query","tls":"","x":520,"y":300,"wires":[["bec2fce5.21b16"]]},{"id":"89e4db76.db53a","type":"http request","z":"e5aacac3.9bf018","name":"用户服务","method":"POST","ret":"obj","url":"http://172.21.11.172:8764/user/query","timeout":"2000","uniqueId":"http://172.21.11.172:8764/user/query","tls":"","x":520,"y":420,"wires":[["f09d1dac.7b6348"]]},{"id":"bec2fce5.21b16","type":"function","z":"e5aacac3.9bf018","name":"获取商品信息","func":"var product=msg.payload.name;\n\nmsg.payload={\n    \"product\":product\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":688,"y":300,"wires":[["af3f7b84.08fcb8","44782dcf.f505f8"]]},{"id":"af3f7b84.08fcb8","type":"debug","z":"e5aacac3.9bf018","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":680,"y":160,"wires":[]},{"id":"8bd56a4b.87bc8","type":"function","z":"e5aacac3.9bf018","name":"获取商品ID","func":"var productId = msg.payload.productId;\n\nmsg.payload={\n    \"id\":productId\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":300,"wires":[["8d80f44.10404c8","1b261e3e.9d9cba"]]},{"id":"c84aeb6e.599418","type":"function","z":"e5aacac3.9bf018","name":"获取用户ID","func":"var userId = msg.payload.userId;\n\nmsg.payload={\n    \"id\": userId\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":420,"wires":[["89e4db76.db53a","ef83cea2.d85a"]]},{"id":"f09d1dac.7b6348","type":"function","z":"e5aacac3.9bf018","name":"获取用户信息","func":"var user=msg.payload.name;\n\nmsg.payload={\n    \"user\":user\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":420,"wires":[["fac49e99.b20c8","44782dcf.f505f8"]]},{"id":"fac49e99.b20c8","type":"debug","z":"e5aacac3.9bf018","name":"","active":true,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":700,"y":540,"wires":[]},{"id":"ef83cea2.d85a","type":"debug","z":"e5aacac3.9bf018","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":360,"y":540,"wires":[],"inputLabels":["dsadasdsadsad"]},{"id":"1b261e3e.9d9cba","type":"debug","z":"e5aacac3.9bf018","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"true","x":330,"y":160,"wires":[]},{"id":"7cceec73.0417d4","type":"http response","z":"e5aacac3.9bf018","name":"","statusCode":"200","headers":{"content-type":"application/json"},"x":1460,"y":360,"wires":[]},{"id":"c3cc03e4.000028","type":"debug","z":"e5aacac3.9bf018","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":1200,"y":280,"wires":[]},{"id":"88df0474.7cbf5","type":"http in","z":"e5aacac3.9bf018","name":"创建订单【组合服务】","url":"/create/order11","method":"post","upload":false,"swaggerDoc":"","x":140,"y":380,"wires":[["8bd56a4b.87bc8","c84aeb6e.599418"]]},{"id":"44782dcf.f505f8","type":"join","z":"e5aacac3.9bf018","name":"组装参数","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"3","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1000,"y":360,"wires":[["c3cc03e4.000028","d32e4b79.61982"]]},{"id":"8d809059.ea101","type":"debug","z":"e5aacac3.9bf018","name":"","active":true,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":1420,"y":280,"wires":[]},{"id":"d32e4b79.61982","type":"http request","z":"e5aacac3.9bf018","name":"订单信息","method":"POST","ret":"obj","url":"http://172.21.11.172:8762/order/add","timeout":"2000","uniqueId":"http://172.21.11.172:8762/order/add","tls":"","x":1220,"y":360,"wires":[["7cceec73.0417d4","8d809059.ea101"]]},{"id":"ad958b9d.388448","type":"http request","z":"13c3b8cc.1182d7","name":"商品服务","method":"POST","ret":"obj","url":"http://172.21.11.172:8763/product/query","timeout":"3000","uniqueId":"http://172.21.11.172:8763/product/query","tls":"","x":560,"y":340,"wires":[["bd4be0d9.c2634"]]},{"id":"8e0ebebf.65687","type":"http request","z":"13c3b8cc.1182d7","name":"用户服务","method":"POST","ret":"obj","url":"http://172.21.11.172:8764/user/query","timeout":"3000","uniqueId":"http://172.21.11.172:8764/user/query","tls":"","x":560,"y":400,"wires":[["e7301d2a.194c38"]]},{"id":"bd4be0d9.c2634","type":"function","z":"13c3b8cc.1182d7","name":"获取商品信息","func":"var product=msg.payload.name;\n\nmsg.payload={\n    \"product\":product\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":800,"y":340,"wires":[["903dc8a0.633ce8","21ee56d0.39c5be"]]},{"id":"903dc8a0.633ce8","type":"debug","z":"13c3b8cc.1182d7","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":900,"y":140,"wires":[]},{"id":"e7301d2a.194c38","type":"function","z":"13c3b8cc.1182d7","name":"获取用户信息","func":"var user=msg.payload.name;\n\nmsg.payload={\n    \"user\":user\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":800,"y":400,"wires":[["c2ce275b.a29d78","21ee56d0.39c5be"]]},{"id":"c2ce275b.a29d78","type":"debug","z":"13c3b8cc.1182d7","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":920,"y":520,"wires":[]},{"id":"bf3df492.7c8758","type":"debug","z":"13c3b8cc.1182d7","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":560,"y":460,"wires":[],"inputLabels":["dsadasdsadsad"]},{"id":"57518694.10a87","type":"debug","z":"13c3b8cc.1182d7","name":"","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"true","x":570,"y":240,"wires":[]},{"id":"5393c237.dd97e8","type":"http response","z":"13c3b8cc.1182d7","name":"","statusCode":"200","headers":{"content-type":"application/json"},"x":1620,"y":340,"wires":[]},{"id":"2f3f7d95.e82ebe","type":"http in","z":"13c3b8cc.1182d7","name":"创建订单【组合服务】","url":"/create/order","method":"post","upload":false,"swaggerDoc":"","x":160,"y":100,"wires":[["20a82e9b.853286"]]},{"id":"21ee56d0.39c5be","type":"join","z":"13c3b8cc.1182d7","name":"组装参数","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"3","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1020,"y":340,"wires":[["7b71aab7.ed3304"]]},{"id":"998eeb5a.8616f8","type":"debug","z":"13c3b8cc.1182d7","name":"","active":true,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","x":1620,"y":240,"wires":[]},{"id":"64375597.79d43","type":"http request","z":"13c3b8cc.1182d7","name":"订单信息","method":"POST","ret":"obj","url":"http://172.21.11.172:8762/order/add","timeout":"3000","uniqueId":"http://172.21.11.172:8762/order/add","tls":"","x":1400,"y":340,"wires":[["5393c237.dd97e8","998eeb5a.8616f8"]]},{"id":"20a82e9b.853286","type":"function","z":"13c3b8cc.1182d7","name":"拆分请求","func":"var productId = msg.payload.productId;\nvar userId = msg.payload.userId;\n\nmsg.payload=[{\"id\":productId},{\"id\":userId}];\n\nreturn msg;","outputs":1,"noerr":0,"x":238,"y":200,"wires":[["2838f633.f7c976"]]},{"id":"2838f633.f7c976","type":"split","z":"13c3b8cc.1182d7","name":"按规则拆分","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":228,"y":280,"wires":[["a5559c28.7c9678"]]},{"id":"a5559c28.7c9678","type":"switch","z":"13c3b8cc.1182d7","name":"分服务调用","property":"parts.index","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":228,"y":380,"wires":[["ad958b9d.388448","57518694.10a87"],["8e0ebebf.65687","bf3df492.7c8758"]]},{"id":"7b71aab7.ed3304","type":"function","z":"13c3b8cc.1182d7","name":"组装服务入参","func":"var product = msg.payload[0].product;\nvar user = msg.payload[1].user;\n\nmsg.payload = {\n    \"product\": product,\n    \"user\": user\n}\nreturn msg;","outputs":1,"noerr":0,"x":1220,"y":340,"wires":[["64375597.79d43"]]}]